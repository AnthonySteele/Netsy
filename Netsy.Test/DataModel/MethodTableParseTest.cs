//-----------------------------------------------------------------------
// <copyright file="MethodTableParseTest.cs" company="AFS">
//  This source code is part of Netsy http://github.com/AnthonySteele/Netsy/
//  and is made available under the terms of the Microsoft Public License (Ms-PL)
//  http://www.opensource.org/licenses/ms-pl.html
// </copyright>
//----------------------------------------------------------------------- 
namespace Netsy.Test.DataModel
{
    using Microsoft.VisualStudio.TestTools.UnitTesting;

    using Netsy.DataModel;
    using Netsy.Helpers;

    /// <summary>
    /// Test parsing the method table data
    /// </summary>
    [TestClass]
    public class MethodTableParseTest
    {
        /// <summary>
        /// Sample data listing methods
        /// </summary>
        private const string methodTableData = @"{""count"":34,""results"":[{""name"":""getUserDetails"",""description"":""Get the details of a user."",""uri"":""\/users\/{user_id}"",""params"":{""user_id"":""user_id_or_name"",""detail_level"":""enum(low, medium, high)""},""type"":""user"",""http_method"":""GET""},{""name"":""getFavorersOfShop"",""description"":""Get all the users who call this shop a favorite."",""uri"":""\/shops\/{user_id}\/favorers"",""params"":{""user_id"":""user_id_or_name"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""user"",""http_method"":""GET""},{""name"":""getFavorersOfListing"",""description"":""Get all the users who call this listing a favorite."",""uri"":""\/listings\/{listing_id}\/favorers"",""params"":{""listing_id"":""int"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""user"",""http_method"":""GET""},{""name"":""getUsersByName"",""description"":""Search active users alphabetically by user_name."",""uri"":""\/users\/keywords\/{search_name}"",""params"":{""search_name"":""string"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""user"",""http_method"":""GET""},{""name"":""getShopDetails"",""description"":""Get the details of a seller's shop."",""uri"":""\/shops\/{user_id}"",""params"":{""user_id"":""user_id_or_name"",""detail_level"":""enum(low, medium, high)""},""type"":""shop"",""http_method"":""GET""},{""name"":""getFeaturedSellers"",""description"":""Get a list of all the featured sellers."",""uri"":""\/shops\/featured"",""params"":{""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""shop"",""http_method"":""GET""},{""name"":""getShopsByName"",""description"":""Search all active shops sorted alphabetically by user_name."",""uri"":""\/shops\/keywords\/{search_name}"",""params"":{""search_name"":""string"",""sort_order"":""enum(up, down)"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""shop"",""http_method"":""GET""},{""name"":""getFavoriteShopsOfUser"",""description"":""Get the favorite shops of a user."",""uri"":""\/users\/{user_id}\/favorites\/shops"",""params"":{""user_id"":""user_id_or_name"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""shop"",""http_method"":""GET""},{""name"":""getListingDetails"",""description"":""Get the details of a listing."",""uri"":""\/listings\/{listing_id}"",""params"":{""listing_id"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getAllListings"",""description"":""Get all active listings on Etsy."",""uri"":""\/listings\/all"",""params"":{""sort_on"":""enum(created, ending)"",""sort_order"":""enum(up, down)"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getShopListings"",""description"":""Get all the listings in a shop."",""uri"":""\/shops\/{user_id}\/listings"",""params"":{""user_id"":""user_id_or_name"",""sort_on"":""enum(created, price)"",""sort_order"":""enum(up, down)"",""section_id"":""int"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getFeaturedDetails"",""description"":""Get the expanded details on featured listings of a shop, ordered by highest ranked featured item."",""uri"":""\/shops\/{user_id}\/listings\/featured"",""params"":{""user_id"":""user_id_or_name"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getFrontFeaturedListings"",""description"":""Get the featured listings on the front page for the current day."",""uri"":""\/listings\/featured\/front"",""params"":{""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getFavoriteListingsOfUser"",""description"":""Get the favorite listings of a user."",""uri"":""\/users\/{user_id}\/favorites\/listings"",""params"":{""user_id"":""user_id_or_name"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getGiftGuideListings"",""description"":""Get the listings in a gift guide."",""uri"":""\/gift-guides\/{guide_id}\/listings"",""params"":{""guide_id"":""int"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getListingsByKeyword"",""description"":""Search for listings by keyword."",""uri"":""\/listings\/keywords\/{search_terms}"",""params"":{""search_terms"":""array(string)"",""sort_on"":""enum(created, price)"",""sort_order"":""enum(up, down)"",""min_price"":""float"",""max_price"":""float"",""search_description"":""enum(true, false)"",""limit"":""int"",""offset"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getListingsByTags"",""description"":""Search for listings by tags."",""uri"":""\/listings\/tags\/{tags}"",""params"":{""tags"":""array(string)"",""sort_on"":""enum(created, price)"",""sort_order"":""enum(up, down)"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getListingsByMaterials"",""description"":""Search for listings by materials used."",""uri"":""\/listings\/materials\/{materials}"",""params"":{""materials"":""array(string)"",""sort_on"":""enum(created, price)"",""sort_order"":""enum(up, down)"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getListingsByCategory"",""description"":""Search for listings by category."",""uri"":""\/listings\/category\/{category}"",""params"":{""category"":""string"",""sort_on"":""enum(created, price)"",""sort_order"":""enum(up, down)"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getListingsByColor"",""description"":""Search for listings by average color of primary image."",""uri"":""\/listings\/color\/{color}"",""params"":{""color"":""color_triplet"",""wiggle"":""int"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getListingsByColorAndKeywords"",""description"":""Search for listings by keywords and average color of primary image."",""uri"":""\/listings\/color\/{color}\/keywords\/{search_terms}"",""params"":{""search_terms"":""array(string)"",""color"":""color_triplet"",""wiggle"":""int"",""offset"":""int"",""limit"":""int"",""detail_level"":""enum(low, medium, high)""},""type"":""listing"",""http_method"":""GET""},{""name"":""getTopTags"",""description"":""Get the list of current top level tags."",""uri"":""\/tags"",""params"":null,""type"":""tag"",""http_method"":""GET""},{""name"":""getChildTags"",""description"":""Get the child tags of a tag."",""uri"":""\/tags\/{tag}\/children"",""params"":{""tag"":""string""},""type"":""tag"",""http_method"":""GET""},{""name"":""getTopCategories"",""description"":""Get the list of current top level categories."",""uri"":""\/categories"",""params"":null,""type"":""category"",""http_method"":""GET""},{""name"":""getChildCategories"",""description"":""Get the child categories of a category."",""uri"":""\/categories\/{category}\/children"",""params"":{""category"":""string""},""type"":""category"",""http_method"":""GET""},{""name"":""getGiftGuides"",""description"":""Get a list of gift guides."",""uri"":""\/gift-guides"",""params"":null,""type"":""gift-guide"",""http_method"":""GET""},{""name"":""getFeedback"",""description"":""Get a feedback record."",""uri"":""\/feedback\/{feedback_id}"",""params"":{""feedback_id"":""int""},""type"":""feedback"",""http_method"":""GET""},{""name"":""getFeedbackForUser"",""description"":""Get a list of all feedback for a particular user."",""uri"":""\/users\/{user_id}\/feedback"",""params"":{""user_id"":""user_id_or_name"",""limit"":""int"",""offset"":""int""},""type"":""feedback"",""http_method"":""GET""},{""name"":""getFeedbackAsBuyer"",""description"":""Get a list of all feedback where the user was a buyer in the transaction."",""uri"":""\/users\/{user_id}\/feedback\/buyer"",""params"":{""user_id"":""user_id_or_name"",""limit"":""int"",""offset"":""int""},""type"":""feedback"",""http_method"":""GET""},{""name"":""getFeedbackAsSeller"",""description"":""Get a list of all feedback where the user was a seller in the transaction."",""uri"":""\/users\/{user_id}\/feedback\/seller"",""params"":{""user_id"":""user_id_or_name"",""limit"":""int"",""offset"":""int""},""type"":""feedback"",""http_method"":""GET""},{""name"":""getFeedbackForOthers"",""description"":""Get a list of all feedback that the user left feedback for someone else."",""uri"":""\/users\/{user_id}\/feedback\/others"",""params"":{""user_id"":""user_id_or_name"",""limit"":""int"",""offset"":""int""},""type"":""feedback"",""http_method"":""GET""},{""name"":""getMethodTable"",""description"":""Get a list of all methods available."",""uri"":""\/"",""params"":null,""type"":""method"",""http_method"":""GET""},{""name"":""getServerEpoch"",""description"":""Get server time, in epoch seconds notation."",""uri"":""\/server\/epoch"",""params"":null,""type"":""int"",""http_method"":""GET""},{""name"":""ping"",""description"":""Check that the server is alive."",""uri"":""\/server\/ping"",""params"":null,""type"":""string"",""http_method"":""GET""}],""params"":null,""type"":""method""}";

        /// <summary>
        /// Test parsing the method table
        /// </summary>
        [TestMethod]
        public void MethodTableResponseParse()
        {
            MethodTable methods = methodTableData.Deserialize<MethodTable>();

            Assert.IsNotNull(methods);
            Assert.AreEqual(34, methods.Count);

            Method method1 = methods.Results[0];

            Assert.IsNotNull(method1);
            //Assert.AreEqual(2, method1.Params.Length);
        }
    
    }
}
